## Generated by Amazon Q

### Prompt:

  Run with  python 3 and don’t use panda
Analyse the CSV file kappture-haven-stock-position.csv 
For each distinct outlet 

get a list of distinct barcodes from the Barcode field, which should be split based on a comma


Identify duplicated barcodes with Property barcode set to Barcode

For each distinct duplicate barcode, generate a list of products with the following properties
Name
ProductId
OpeningQuantity
DeliveryQuantity
SoldQuantity
IsCorrect which should be a flag set to true if the Name contains both an x and *

The list of products should be sorted with the highest ProductId first

The file should be re-analysed and where there is more than one product for a barcode where IsCorrect=true, the isCorrect value should be set  to false for all products other than the one with the highest ProductId

Re-analyse the file and for each product add new properties to the product where isCorrect=true: CorrectOpeningQuantity = SUM of all OpeningQuantity
CorrectDeliveryQuantity = SUM of all DeliveryQuantity
CorrectSoldQuantity = SUM of all SoldQuantity

Output the result as JSON file in a separate file for each outlet in the output directory

Generate a Distinct list of all ProductId from the file To Be deleted only where IsCorrect=false

Generate a CSV file with the following fields and based on the Products and only where IsCorrect=true: ProductId, Outlet, CorrectOpeningQuantity,
CorrectSoldQuantity,
CorrectDeliveryQuantity
